<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="initial-scale=1, width=device-width">
    <title>Qué ves en la imagen?</title>
    <link href="styles.css" rel="stylesheet">

</head>
<body>
    <h1>Qué ves en la imagen?</h1>
    <form method="POST" action="/test" class="form">
        <div class="image-container">
            <img src="imagen1.jpg" alt="Imagen" class="fixed-size-image">
        </div>
        <pre></pre>
        <div>
            <button class="btn btn-primary guardar-btn" type="button" name="animales" onclick="incrementarVariable(1)">Animales</button>
            <button class="btn btn-primary guardar-btn" type="button" name="seres-humanos" onclick="incrementarVariable(2)">Seres humanos</button>
            <button class="btn btn-primary guardar-btn" type="button" name="plantas" onclick="incrementarVariable(3)">Huesos humanos</button>
            <button class="btn btn-primary guardar-btn" type="button" name="organos-cuerpo" onclick="incrementarVariable(4)">Órganos del cuerpo</button>
        </div>
        <pre></pre>
        <div class="buttons-container">
            <button class="btn btn-primary" type="button" onclick="cambiarImagen()">Siguiente</button>
        </div>
    </form>

    <script>
        var variable1 = 0;
        var variable2 = 0;
        var variable3 = 0;
        var variable4 = 0;

        var imagenActual = 1;
        var totalImagenes = 10;

        function incrementarVariable(variable) {
            switch (variable) {
                case 1:
                    variable1++;
                    break;
                case 2:
                    variable2++;
                    break;
                case 3:
                    variable3++;
                    break;
                case 4:
                    variable4++;
                    break;
            }
        }

        function cambiarImagen() {
            imagenActual++;
            if (imagenActual > totalImagenes) {
                var resultado = '';
                if (variable1 > variable2 && variable1 > variable3 && variable1 > variable4) {
                    resultado = 'resultado1';
                } else if (variable2 > variable1 && variable2 > variable3 && variable2 > variable4) {
                    resultado = 'resultado2';
                } else if (variable3 > variable1 && variable3 > variable2 && variable3 > variable4) {
                    resultado = 'resultado3';
                } else if (variable4 > variable1 && variable4 > variable2 && variable4 > variable3) {
                    resultado = 'resultado4';
                } else {
                    resultado = 'ningún resultado determinado';
                }

                fetch('/resultado', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({ resultado: resultado })
                })
                    .then(response => {
                        alert('Resultado enviado exitosamente');
                    })
                    .catch(error => {
                        alert('Error al enviar el resultado');
                        console.error(error);
                    });

                // Redirigir a result.html con el resultado como parámetro de la URL
                window.location.href = "/result?resultado=" + resultado;
                return;  // Detener la ejecución del código restante en esta función
            }

            var imgElement = document.querySelector(".image-container img");
            imgElement.src = "imagen" + imagenActual + ".jpg";
        }
    </script>
</body>
</html>
